# Workshop 4: การรวมศูนย์ข้อมูลและการอัปเกรดรายงาน (Master Data & Reconnect)

## สถานการณ์จำลอง

เมื่อเริ่มต้นงบประมาณใหม่ ท่านพบว่าต้องสร้างรายงานใน Looker Studio ที่มีหน้าตาแบบเดิมซ้ำอีกครั้ง เพียงแต่เปลี่ยนข้อมูลให้เป็นของปีงบประมาณใหม่ จึงสงสัยว่ามีวิธีสร้างรายงานเพียงครั้งเดียว แต่ใช้ได้ตลอดหรือไม่ โดยไม่ต้องสร้างไฟล์ใหม่ทุกปี

## วัตถุประสงค์

1. รวมข้อมูลหลายปีงบประมาณให้อยู่ในตารางเดียว (Master Data)
2. สร้างโครงสร้างข้อมูลที่รองรับปีงบประมาณใหม่ในอนาคต
3. เปลี่ยนแหล่งข้อมูลรายงานให้ชี้ไปที่แผ่นงาน **Master_Data**
4. เพิ่มตัวกรองปีงบประมาณเพื่อให้ผู้ใช้เลือกดูข้อมูลตามปีที่ต้องการ

## การสร้างแผ่นงาน Master_Data

เราจะสร้างแผ่นงานใหม่เพื่อรวบรวมข้อมูลทุกปีไว้ด้วยกัน

1. กลับไปที่ไฟล์ Google Sheets ของท่าน
2. กดเครื่องหมาย **+** ที่มุมล่างซ้ายเพื่อสร้างแผ่นงานใหม่
3. ดับเบิ้ลคลิกที่ชื่อแผ่นงานแล้วเปลี่ยนชื่อเป็น **Master_Data**
4. กำหนดโครงสร้างคอลัมน์:
    - ในเซลล์ **A1** พิมพ์คำว่า `ปีงบประมาณ`
    - คัดลอกหัวตาราง (Header) จากแผ่นงานปี 65 (ตั้งแต่ A1 ถึงคอลัมน์สุดท้าย) มาวางต่อที่เซลล์ **B1** ของแผ่นงาน Master_Data

## การรวมข้อมูลทุกปีเข้าด้วยกัน

เราจะนำข้อมูลจากแต่ละปีมาต่อกันในแนวตั้ง (Append)

### ข้อมูลปี 2565
1. ไปที่แผ่นงาน **65**
2. คัดลอกข้อมูลทั้งหมด **ยกเว้นหัวตาราง** (เริ่มตั้งแต่แถวที่ 2 ลงไป)
3. กลับมาที่แผ่นงาน **Master_Data**
4. วางข้อมูลที่เซลล์ **B2**
5. ในคอลัมน์ A (ปีงบประมาณ) ให้พิมพ์ `2565` ลงในเซลล์ A2 แล้วลากลงมาจนสุดข้อมูลของปี 65

### ข้อมูลปี 2566 และ 2567
1. ทำซ้ำขั้นตอนเดิมกับข้อมูลปี 66 และ 67
2. นำข้อมูลมาวางต่อท้ายแถวสุดท้ายของข้อมูลที่มีอยู่
3. เติมปีงบประมาณ `2566` และ `2567` ในคอลัมน์ A ให้ครบทุกแถว

**ผลลัพธ์:** ท่านจะมีตารางข้อมูลขนาดใหญ่ที่รวมข้อมูลทุกปีไว้ในแผ่นงานเดียว โดยมีคอลัมน์ A ระบุว่าเป็นข้อมูลของปีใด

## การ Reconnect แหล่งข้อมูลไปที่ Master_Data

เราจะเปลี่ยนให้ Looker Studio ไปดึงข้อมูลจาก Master_Data แทนแผ่นงานรายปี

1. กลับไปที่ Looker Studio ในโหมดแก้ไข (Edit)
2. ไปที่เมนู **ทรัพยากร (Resource) > จัดการแหล่งข้อมูลที่เพิ่มเข้ามา (Manage added data sources)**
3. คลิก **แก้ไข (Edit)** ที่แหล่งข้อมูลเดิมของท่าน
4. คลิก **แก้ไขการเชื่อมต่อ (Edit connection)** ที่มุมซ้ายบน
5. เลือกแผ่นงาน **Master_Data**
6. กด **เชื่อมต่อใหม่ (Reconnect)**
7. ระบบจะแจ้งเตือนการเปลี่ยนแปลงฟิลด์ (ถ้ามี) หรือแจ้งว่าพบฟิลด์ใหม่ (ปีงบประมาณ) ให้กด **ใช้ (Apply)**
8. กด **เสร็จสิ้น (Done)** และ **ปิด (Close)**

## การเพิ่มตัวกรองปีงบประมาณ

เพื่อให้ผู้ใช้งานเลือกดูข้อมูลเฉพาะปีที่ต้องการได้

1. คลิกเมนู **เพิ่มตัวควบคุม (Add a control)**
2. เลือก **รายการแบบเลื่อนลง (Drop-down list)**
3. วางตัวกรองไว้ที่ส่วนหัวของรายงาน (ข้างๆ ชื่อรายงาน)
4. ตั้งค่าในแถบ **ตั้งค่า (Setup)**:
    - **ฟิลด์ตัวควบคุม (Control field):** เลือก `ปีงบประมาณ`
5. ทดสอบการใช้งานโดยกดปุ่ม **ดู (View)** ที่มุมขวาบน แล้วลองเปลี่ยนปีใน Drop-down กราฟทั้งหมดควรอัปเดตตามปีที่เลือก

## ข้อดีของวิธีนี้
เมื่อมีข้อมูลปีงบประมาณใหม่ (เช่น ปี 2568) ท่านเพียงแค่นำข้อมูลมาต่อท้ายในแผ่นงาน Master_Data แล้วกด Refresh ใน Looker Studio ข้อมูลปีใหม่ก็จะปรากฏขึ้นมาให้เลือกทันที โดยไม่ต้องสร้างรายงานใหม่
