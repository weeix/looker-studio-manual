# Workshop 3: การสร้างการแสดงผล (Visualization)

## สถานการณ์จำลอง

ผู้บริหารต้องการเห็นข้อมูลงบประมาณและการเบิกจ่ายในรูปแบบกราฟและตารางที่ตอบคำถามทางธุรกิจได้อย่างรวดเร็ว ท่านจึงต้องออกแบบหน้ารายงานที่สวยงามและสื่อความหมายได้ดี

## วัตถุประสงค์

1. ออกแบบหน้ารายงานด้วยองค์ประกอบพื้นฐาน (ชื่อรายงาน กราฟ ตาราง)
2. สร้าง Visualization หลักเพื่อช่วยตอบคำถามเรื่องแหล่งงบประมาณ การเบิกจ่าย และรายละเอียดตามหน่วยปฏิบัติ
3. สร้าง Calculated Field เพื่อคำนวณเปอร์เซ็นต์การเบิกจ่าย

## การตั้งชื่อรายงาน

1. ที่มุมบนซ้ายของหน้าจอ คลิกที่ข้อความ **Untitled Report** (หรือ รายงานที่ไม่มีชื่อ)
2. เปลี่ยนชื่อเป็น `รายงานติดตามงบประมาณ ประจำปี 2567`
3. เพิ่มหัวข้อรายงานบนหน้ากระดาษ:
    - คลิกที่ไอคอน **ข้อความ (Text)** รูปตัว **A** บนแถบเครื่องมือด้านบน
    - ลากเมาส์วาดกรอบข้อความบริเวณส่วนบนของรายงาน
    - พิมพ์ข้อความ `รายงานติดตามงบประมาณ ประจำปี 2567`
    - ปรับขนาดตัวอักษรให้ใหญ่ขึ้น (เช่น 32px) และจัดกึ่งกลางที่แถบ **คุณสมบัติ (Properties)** ด้านขวา

## กราฟสัดส่วนแหล่งงบประมาณ (Pie Chart)

**คำถามที่ตอบ:** งบปีนี้มาจากส่วนกลางหรือภูมิภาคมากกว่ากัน?

1. คลิกเมนู **เพิ่มแผนภูมิ (Add a chart)** บนแถบเครื่องมือ
2. เลือก **แผนภูมิวงกลม (Pie chart)**
3. คลิกวางแผนภูมิลงบนพื้นที่ว่าง
4. ตั้งค่าข้อมูลในแถบ **ตั้งค่า (Setup)** ด้านขวา:
    - **มิติข้อมูล (Dimension):** ลากฟิลด์ `แหล่งงบประมาณ` มาใส่
    - **เมตริก (Metric):** ลากฟิลด์ `งบประมาณ` มาใส่
5. (ตัวเลือกเสริม) ปรับแต่งความสวยงามที่แถบ **รูปแบบ (Style)** เช่น เปลี่ยนสี หรือแสดงป้ายกำกับข้อมูล

## สถานะการเบิกจ่ายภาพรวม (Gauge/Scorecard)

**คำถามที่ตอบ:** เบิกจ่ายไปแล้วกี่เปอร์เซ็นต์?

### ขั้นตอนที่ 1: สร้างฟิลด์คำนวณ (Calculated Field)
เนื่องจากในข้อมูลต้นฉบับไม่มีคอลัมน์ "% การเบิกจ่าย" เราจึงต้องสร้างขึ้นเอง

1. ที่แถบ **ข้อมูล (Data)** ด้านขวาล่าง คลิกปุ่ม **+ เพิ่มฟิลด์ (+ Add a field)**
2. ตั้งชื่อฟิลด์ (Field Name) ว่า `% การเบิกจ่าย`
3. ในช่องสูตร (Formula) พิมพ์สูตรดังนี้:
    ```sql
    SUM(ยอดเบิกจ่าย) / SUM(งบประมาณ)
    ```
    *(เมื่อพิมพ์ชื่อฟิลด์ ระบบจะแสดงรายการขึ้นมา ให้คลิกเลือกจากรายการเพื่อให้แน่ใจว่าชื่อฟิลด์ถูกต้อง)*
4. กด **บันทึก (Save)** และ **เสร็จสิ้น (Done)**

### ขั้นตอนที่ 2: สร้างแผนภูมิเกจ (Gauge Chart)
1. คลิกเมนู **เพิ่มแผนภูมิ (Add a chart)**
2. เลือก **เกจ (Gauge)**
3. วางแผนภูมิลงบนพื้นที่ว่าง
4. ตั้งค่าข้อมูลในแถบ **ตั้งค่า (Setup)**:
    - **เมตริก (Metric):** เลือกฟิลด์ `% การเบิกจ่าย` ที่เพิ่งสร้างขึ้น
5. คลิกที่รูปดินสอหน้าชื่อเมตริก `% การเบิกจ่าย` เพื่อเปลี่ยนหน่วย
    - ที่หัวข้อ **ประเภท (Type)** เลือก **ตัวเลข (Numeric) > เปอร์เซ็นต์ (Percent)**
6. ปรับแต่งช่วงสีในแถบ **รูปแบบ (Style)** ตามต้องการ

## การเบิกจ่ายจำแนกตามกลุ่ม (Stacked Bar / Column)

เราจะสร้างกราฟแท่งเพื่อเปรียบเทียบยอดเบิกจ่ายและงบประมาณคงเหลือในมิติต่างๆ

### กราฟ 4.1: จำแนกตามแหล่งงบประมาณ
1. เพิ่มแผนภูมิ **คอลัมน์แบบซ้อนกัน (Stacked column chart)**
2. **มิติข้อมูล (Dimension):** `แหล่งงบประมาณ`
3. **เมตริก (Metric):** ลากฟิลด์ `ยอดเบิกจ่าย` และ `งบประมาณคงเหลือ (GF)` มาใส่ (ใส่ทั้ง 2 ฟิลด์)
4. จะได้กราฟแท่งที่แสดงยอดรวม โดยแบ่งสีเป็นยอดเบิกจ่ายและยอดคงเหลือ

### กราฟ 4.2 และ 4.3
ใช้วิธีการ **คัดลอก (Copy)** กราฟ 4.1 แล้วเปลี่ยน **มิติข้อมูล (Dimension)** เป็น:
- **กราฟ 4.2:** เปลี่ยน Dimension เป็น `ชื่อกิจกรรม`
- **กราฟ 4.3:** เปลี่ยน Dimension เป็น `หน่วยปฏิบัติ` (อาจเปลี่ยนเป็นกราฟแท่งแนวนอน Bar chart เพื่อให้อ่านชื่อหน่วยงานได้ง่ายขึ้น)

## ตารางสรุปรายละเอียด (Pivot Table)

เพื่อดูรายละเอียดตัวเลขรายหน่วยงานและกิจกรรม

1. เพิ่มแผนภูมิ **Pivot table** (อยู่ด้านล่างสุดของเมนู Add a chart)
2. **มิติข้อมูลแถว (Row Dimension):** `หน่วยปฏิบัติ`
3. **มิติข้อมูลคอลัมน์ (Column Dimension):** `ชื่อกิจกรรม`
4. **เมตริก (Metric):** `งบประมาณ`, `ยอดเบิกจ่าย`

## บทสรุป

ใน Workshop นี้ ท่านได้เรียนรู้วิธีการสร้าง Visualization พื้นฐานและการสร้าง Calculated Field ซึ่งเป็นหัวใจสำคัญของการทำรายงานใน Looker Studio ใน Workshop ถัดไป เราจะเรียนรู้วิธีการจัดการข้อมูลขั้นสูงเพื่อรองรับข้อมูลหลายปีงบประมาณ
