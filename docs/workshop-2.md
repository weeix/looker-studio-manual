# Workshop 2: การเชื่อมต่อข้อมูล (Data Connection)

## สถานการณ์จำลอง

ผู้บริหารต้องการเห็นภาพรวมการเบิกจ่ายปี 2567 แบบรวดเร็ว ไม่ต้องอ่านตารางยาว จึงต้องเชื่อมข้อมูลจาก Google Sheets เข้าสู่ Looker Studio เพื่อสร้างรายงานที่สวยงามและเข้าใจง่าย

## วัตถุประสงค์

1. สร้างรายงานใหม่ใน Looker Studio
2. เชื่อมต่อข้อมูลจาก Google Sheets ที่เตรียมจาก Workshop 1
3. เลือกแผ่นงานปีงบประมาณปัจจุบันให้ถูกต้อง
4. ตรวจสอบความถูกต้องของข้อมูลเบื้องต้น

## การสร้างรายงานใหม่ใน Looker Studio

1. เข้าสู่เว็บไซต์ [Looker Studio](https://lookerstudio.google.com/)
2. คลิกที่ปุ่ม **+ สร้าง (+ Create)** ทางด้านซ้ายบน
3. เลือกเมนู **รายงาน (Report)**
4. หากเป็นการใช้งานครั้งแรก ระบบอาจจะให้ท่านยอมรับข้อตกลงการใช้งาน ให้ทำตามขั้นตอนที่ปรากฏบนหน้าจอจนเสร็จสิ้น

## การเชื่อมต่อกับ Google Sheets

เมื่อท่านสร้างรายงานใหม่ ระบบจะแสดงหน้าต่าง "เพิ่มข้อมูลลงในรายงาน (Add data to report)" โดยอัตโนมัติ

1. ในแถบ **Connect to data**, เลือกตัวเชื่อมต่อ (Connector) ที่ชื่อว่า **Google Sheets**
2. เลือก **Spreadsheet** (ไฟล์) ที่ท่านได้ทำสำเนาไว้จาก Workshop 1 (เช่น `Workshop_ชื่อของท่าน`)
3. เลือก **Worksheet** (แผ่นงาน) ที่ต้องการเชื่อมต่อ ในที่นี้ให้เลือกแผ่นงานปีปัจจุบัน เช่น **67** (หรือปีงบประมาณล่าสุดที่มีข้อมูล)
4. ตรวจสอบว่าตัวเลือกด้านขวาถูกติ๊กถูกทั้ง 2 ช่อง:
    - **ใช้แถวแรกเป็นส่วนหัว (Use first row as headers)**
    - **รวมเซลล์ที่ซ่อนและกรอง (Include hidden and filtered cells)**
5. กดปุ่ม **เพิ่ม (Add)** ที่มุมล่างขวา
6. จะมีหน้าต่างยืนยันการเพิ่มข้อมูล ให้กดปุ่ม **เพิ่มในรายงาน (Add to report)**

    !!! tip "เคล็ดลับ"
        หากท่านไม่เห็นหน้าต่างเลือกไฟล์ อาจเป็นเพราะ Pop-up blocker ของเบราว์เซอร์ทำงานอยู่ ให้สังเกตที่แถบ address bar ด้านบนขวา หากมีไอคอนกากบาทสีแดง ให้คลิกและเลือก "อนุญาต (Allow)"

## การตรวจสอบความถูกต้องของข้อมูล (Data Verification)

เมื่อเชื่อมต่อข้อมูลเสร็จแล้ว ท่านจะเห็นตารางข้อมูลปรากฏอยู่บนหน้ากระดาษ ให้ทำการตรวจสอบเบื้องต้นดังนี้:

1. สังเกตที่แถบ **ข้อมูล (Data)** ทางด้านขวามือ จะเห็นรายชื่อคอลัมน์ต่างๆ ที่ดึงมาจาก Google Sheets
2. ตรวจสอบสัญลักษณ์หน้าชื่อคอลัมน์ว่าถูกต้องหรือไม่:
    - **ABC**: ข้อมูลตัวอักษร (Text) เช่น ชื่อกิจกรรม, หมวดรายจ่าย
    - **123**: ข้อมูลตัวเลข (Number) เช่น งบประมาณ, ยอดเบิกจ่าย
    - **Globe**: ข้อมูลภูมิศาสตร์ (Geo) เช่น จังหวัด, ประเทศ
    - **Calendar**: ข้อมูลวันที่ (Date)
3. หากพบว่าคอลัมน์ตัวเลข (เช่น งบประมาณ) แสดงเป็น **ABC** แสดงว่าข้อมูลใน Google Sheets อาจยังมีตัวอักษรปะปนอยู่ ให้กลับไปตรวจสอบและแก้ไขใน Google Sheets อีกครั้ง (ตามขั้นตอนใน Workshop 1) แล้วกด **รีเฟรชข้อมูล (Refresh data)** ใน Looker Studio

ขณะนี้รายงานของท่านพร้อมสำหรับการสร้างกราฟและตารางแล้ว
